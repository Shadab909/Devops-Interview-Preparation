In this video, we will be understanding about users and groups.

In a Linux operating system. So users and group are used to control access to files and resources or

programs or processes, basically files, everything is a file.

So every file in the system will be owned by a user and an associated group with it.

And then you can really control the access on that file by specifying how much permission or authorization

is to that user.

Every user will have a unique user ID.

Which we call it as uid, and all this uid information will be stored in /etc/passwd file, which we

have already seen, but now we understand it much better.

There's also an /etc/shadow file which will have encrypted password and some other information like

expiry of the user and a few other things.

And you create a user.

Usually we assign a home dir and that's done by default.

Sometimes we restrict the home dir also.

Well, there are three kinds of users in Linux, one is a root user and its user ID is zero group id is zero,

its home directory /root and it has a login shell /bin/bash that's the path of bash shell.

Then you have a regular user, like you have a vagrant user or we can create a user like imran user

or any other user, this user will always have user id more than 1000.

It will have a group, its group id will be more than 1000 and these are default numbers, if you

wish, you can change them.

And will have a home dir and a log in shell.

Then there is other kind of user called a service user or system users like FTP, ssh, Apache

and many more.

Now, these are not the usual login user.

You don't use this user to log into the system.

They have user ID starting from one to triple nine and group will have group ID from one to triple nine.

and they will have home directory, probably the /var or /etc or may not even have sometimes home directory

properly.

They will not have a login shell you will see /sbin/nologin or /sbin/false

So to prevent people accessing shell from this user.

So you know, if someone gets hold of this user, these users will not even have password set, but

someone get hold of this user, they will not be able to get any shell to execute commands.

These are for the processes running in the background.

OK, now let's get into our shell of our linux system.

So logon to the vm and switch to root user.

First, let's understand the /etc/passwd file.

That's the entire file, lets just get first

One line of the file, /etc/passwd

OK, let me clear the screen.

And let's do it once again.

So there are total seven columns here, the first one is the user name, then the second one is X,

which means there is a link to shadow file.

Shadow file will hold the password encrypted.

Then you have the user I.D. root user ID is usually zero group I.D., there will be a primary group

for every user that we create and root's group I.D. is zero zero.

And then you have the comment.

Any comment you want to put?

Then you have /root, which is the home dir of the root user, then the logging shell. Let's search

for.

vagrant user, /etc/passwd

OK, so vagrant, that's the user name, link to shadow file, user id 1000, group id one thousand.

Some comment, home dir of our current user and the login shell.

So theres root user and theres normal user, and then you have these other users, which are system

users.

Like bin, Daemon, adm, lp. If you see the logging shell /bin/nologin, their home

dir, /bin, /sbin.

There's also for ssh

A user called sshd.

Will be seeing later, will be setting up other servers like the webserver, database server, and you'll see there's

a user that gets created when you install those packages.

Now, let's check the group file /etc/group, this file will have the group information.

So there that's the vagrant group and that's the groupid, one thousand, and there's a user called

Vagrant in this group, like that you should have groups of other users.

These are the primary groups, we are seeing now, we will also see how we can create our own group and add

users in that.

So that's route user, sorry Root Group.

Now the group name and the user name is similar, right?

And even there userid, groupid is also similar, like we do grep.

To /etc/passwd and we do grep vagrant to /etc/.group.

All right, so there's striking similarities, user I.D. username is same and the group name is also

same, user ID is same, and the group id is also same, but it's really very easy to understand.

This is from the group file and this is from /etc/passwd file.

So this is user information and this is group information.

After groupid colon, you will see the user that belongs to that group.

So for this group, Vagrant, we have a user called a vagrant in that.

OK, that's confusing.

We are going to create some users and group and you will understand very well.

OK, some commands we have, like id command and we give the user name and it will give information about

that user, right.

Like it's user I.D., its group I.D. and other groups where it belongs to, so vagrant user belongs to

a group vagrant and also a group wheel.

Now, let's add our own user.

So I will add a user.

Let's say ansible and I will add a user named Jenkins and I will add a user named AWS, just some name,

OK, you can give any name and you should see then tail -4 /etc/passwd, you should see the user's information

now passwd file

You should also see is similar information in the group file for the group that got created.

OK, so when we created user Ansible, it created a group called us Ansible, which is the primary group.

You can also run id command.

Now we will create a group, groupadd devops.

This command is going to create the group.

Now I want to add all these three users into the group devops.

There are two ways.

One, I can use the usermod, command.

And I'll use the option -aG means the supplementary group or the secondary

group.

If you use a small g, that will be the primary group, so I want to add user into the group devops,

the user I'm going to say is Ansible.

OK, now, if you do, id ansible.

You should see Ansible user is in the group DevOps.

OK, let's also grep for ansible from /etc/group file or I will search for devops in the group file.

So devops group.

You see now devops group has the user ansible in it.

Now, that's one way of adding a user into the group, we add ansible user to devops group.

You can directly edit the group file.

also, /etc/group, open the file.

And you find your group devops and you want to add users here, you can just say comma separated.

I want to add Jenkins' and I also want to add aws user, comma separated.

You can give as many as users you want and save this file.

And then lets run id on aws user and you should see it's in the devops group.

Now, nobody can use this user to log in from outside or any normal user cannot use this to log in because

it does not have any password set.

So to set the password, you can use the passwd command.

passwd command

Or you can use it to reset the password also

passwd and will say ansible.

And it will ask me a new password, I will set some password and I've set a simple password for now.

OK, I will set also password for aws

And also, let's set it for jenkins.

If you want to reset, then you can do the same thing if you forgot the password of that user, but

this can be done only by root user to resetting someone's password. Now being a root user.

I really don't need any password to access other user.

I can simply say su - and the username and no password will be asked.

You see that?

I have switched as ansible user, no password asked.

See, I am in the ansible home directory, but from here. I'm a normal user now, Ansible, I want to switch

to, let's say, aws.

It's asking me password and I have to know the password, then only I can switch. Or from aws User.

I want to switch to Jenkins' user. Again its asking the password.

OK, and you can use exit to log out.

Exit from Jenkins, then exit from aws., then exit from Ansible.

OK, let's clear the screen, few more handy commands. The last command, which will show you.

The user who logged into this systems last and you'll see the time also, so we've been logging in

as vagrant users. We will see the event their vagrant user logged in at this particular time.

And this vagrant user, it's already logged in.

who command, which will show you the current logged in user.

whoami

You've already been seeing this. One more useful.

command

lsof -u and a username, this command will list all the open file by this user.

So if it's not installed, so you can install it.

lsof

OK, yum, install lsof -y.

So before you're deleting any user, you're doing some, you know, serious user operation, you can

see this user has opened.

How many files?

And then based on the information, you can decide what to do with this user.

If you do lsof -u aws, we don't see anything because that user is not logged in.

That's also one more way to find out what user is logged in and doing what.

Really useful command.

OK, now let's talk about deleting the user so you can use usedel command to delete a user and you

give a user name, let's say, aws, so it will just delete the user.

But if you see its home dir will still exist and it's mailing spool will also exist.

If you want to delete a user with its home directory also, then you use -r

So I say userdel -r jenkins and now you should see the home directories also gone.

You can also delete the group by using groupdel command and you give the groupname devops

The group got deleted.

OK, so you have seen some user operations now, but it will be really more effective when you see it

with file permissions and sudo, then you will understand its real uses.

As of now, just practice this.

How to add user, remove user and group.

I will remove the ansible user also, but I have to also remove the home dir

Of aws user, rm -rf /home/aws

As usual, run the history command to see the commands that you have executed and you can practice it

again.